<%
require 'json'
h={:header => [], :response_header => [] }
h[:description]=<<EOD
**Update an order.**

* `items` maps a role to a resource uuid and its update parameters. The item gets the status associated to its `event` parameter.
* `event` updates the order status.
* `pipeline` updates the pipeline parameter
* `study_uuid` updates the study parameter
* `creator_uuid` updates the creator parameter
* `cost_code` updates the cost_code parameter
* `parameters` updates the parameters attribute
* `state` updates the state parameter
EOD
h[:method] = "PUT"
h[:url]='/11111111-2222-3333-4444-555555555555'
h[:header] << 'Accept: application/json'
h[:parameters]=<<EOP
{ "items": { 
    "New tube": {
        "11111111-0000-0000-0000-111111111111": { "event": "start" }
    }
},
"event": "build",
"pipeline": "pipeline 2",
"study_uuid": "11111111-2222-3333-4444-777777777777",
"user_uuid": "11111111-2222-3333-4444-666666666666",
"cost_code": "cost code 2",
"parameters": {"param_1": "custom parameter"},
"state": {"state_1": "information about order state"}
}
EOP
h[:status]=200
h[:response_header] << 'Content-Type: application/json'
h[:response]=<<EOD
{ "order": {
    "actions": {
        "create": "/11111111-2222-3333-4444-555555555555",
        "read": "/11111111-2222-3333-4444-555555555555",
        "update": "/11111111-2222-3333-4444-555555555555",
        "delete": "/11111111-2222-3333-4444-555555555555"
    },
    "uuid": "11111111-2222-3333-4444-555555555555",
    "creator": {
        "actions": {
                "create": "/11111111-2222-3333-4444-666666666666",
                "read": "/11111111-2222-3333-4444-666666666666",
                "update": "/11111111-2222-3333-4444-666666666666",
                "delete": "/11111111-2222-3333-4444-666666666666"
            },
        "uuid": "11111111-2222-3333-4444-666666666666"
    },
    "study": {
        "actions": {
            "create": "/11111111-2222-3333-4444-777777777777",
            "read": "/11111111-2222-3333-4444-777777777777",
            "update": "/11111111-2222-3333-4444-777777777777",
            "delete": "/11111111-2222-3333-4444-777777777777"
        },
        "uuid": "11111111-2222-3333-4444-777777777777"
    },
    "pipeline": "pipeline 2",
    "cost_code": "cost code 2",
    "status": "pending",
    "parameters": {"param_1": "custom parameter"},
    "state": {"state_1": "information about order state"},
    "items": {
        "Stock Plate 1": [
            { "status": "done", "uuid": "11111111-2222-3333-4444-888888888888" }
        ],
        "New Tube": [
            { "status": "in_progress", "uuid": "11111111-0000-0000-0000-111111111111" }
        ],
        "Tube 1": [
            { "status": "pending", "uuid": "11111111-2222-3333-4444-999999999999" }
        ]
    }
} }
EOD
%>
<%= h.to_json %>
